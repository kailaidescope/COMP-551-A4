Starting BERT epoch experiments script
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
{'eval_loss': 1.299783706665039, 'eval_accuracy': 0.6218117854001759, 'eval_f1': 0.4554615032683924, 'eval_runtime': 3.101, 'eval_samples_per_second': 1466.613, 'eval_steps_per_second': 91.905, 'epoch': 1.0}
{'eval_loss': 1.2587521076202393, 'eval_accuracy': 0.6270888302550571, 'eval_f1': 0.48372626117436385, 'eval_runtime': 3.1272, 'eval_samples_per_second': 1454.349, 'eval_steps_per_second': 91.137, 'epoch': 2.0}
{'eval_loss': 1.3240731954574585, 'eval_accuracy': 0.6154353562005277, 'eval_f1': 0.4870965321620065, 'eval_runtime': 3.1112, 'eval_samples_per_second': 1461.799, 'eval_steps_per_second': 91.603, 'epoch': 3.0}
{'eval_loss': 1.5368711948394775, 'eval_accuracy': 0.5923482849604221, 'eval_f1': 0.4904807453173034, 'eval_runtime': 3.1234, 'eval_samples_per_second': 1456.118, 'eval_steps_per_second': 91.247, 'epoch': 4.0}
{'eval_loss': 1.7173081636428833, 'eval_accuracy': 0.5934476693051891, 'eval_f1': 0.49209669031091524, 'eval_runtime': 3.1088, 'eval_samples_per_second': 1462.962, 'eval_steps_per_second': 91.676, 'epoch': 5.0}
{'eval_loss': 2.012099266052246, 'eval_accuracy': 0.5793755496921724, 'eval_f1': 0.4776832587068733, 'eval_runtime': 3.1158, 'eval_samples_per_second': 1459.66, 'eval_steps_per_second': 91.469, 'epoch': 6.0}
{'eval_loss': 2.2529351711273193, 'eval_accuracy': 0.5813544415127528, 'eval_f1': 0.4787527061430278, 'eval_runtime': 3.1095, 'eval_samples_per_second': 1462.632, 'eval_steps_per_second': 91.656, 'epoch': 7.0}
{'eval_loss': 2.4560675621032715, 'eval_accuracy': 0.5868513632365875, 'eval_f1': 0.47681720765187846, 'eval_runtime': 3.1143, 'eval_samples_per_second': 1460.364, 'eval_steps_per_second': 91.514, 'epoch': 8.0}
{'eval_loss': 2.612605333328247, 'eval_accuracy': 0.5857519788918206, 'eval_f1': 0.48307165714939365, 'eval_runtime': 3.1102, 'eval_samples_per_second': 1462.287, 'eval_steps_per_second': 91.634, 'epoch': 9.0}
{'eval_loss': 2.694164991378784, 'eval_accuracy': 0.5837730870712401, 'eval_f1': 0.47719346244426203, 'eval_runtime': 3.1348, 'eval_samples_per_second': 1450.81, 'eval_steps_per_second': 90.915, 'epoch': 10.0}
{'train_runtime': 1098.738, 'train_samples_per_second': 330.452, 'train_steps_per_second': 20.66, 'train_loss': 0.5590376342235683, 'epoch': 10.0}
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [24  0 20 ... 27  0  4]
Metrics:
F1: 0.4909053212730721 
Accuracy: 0.5856209150326798
Results: {'f1': [0.4554615032683924, 0.48372626117436385, 0.4870965321620065, 0.4904807453173034, 0.49209669031091524, 0.4776832587068733, 0.4787527061430278, 0.47681720765187846, 0.48307165714939365, 0.47719346244426203, 0.4909053212730721], 'accuracy': [0.6218117854001759, 0.6270888302550571, 0.6154353562005277, 0.5923482849604221, 0.5934476693051891, 0.5793755496921724, 0.5813544415127528, 0.5868513632365875, 0.5857519788918206, 0.5837730870712401, 0.5856209150326798], 'duration': [114.38550090789795, 224.50773572921753, 334.9790663719177, 444.8615868091583, 554.7388515472412, 664.6537897586823, 774.3442935943604, 884.1396660804749, 994.0344994068146, 1103.8730282783508, 1107.0093100070953], 'final': {'f1': 0.4909053212730721, 'accuracy': 0.5856209150326798, 'duration': 1107.0127210617065}}
F1 scores: [0.4554615032683924, 0.48372626117436385, 0.4870965321620065, 0.4904807453173034, 0.49209669031091524, 0.4776832587068733, 0.4787527061430278, 0.47681720765187846, 0.48307165714939365, 0.47719346244426203, 0.4909053212730721]
Accuracies: [0.6218117854001759, 0.6270888302550571, 0.6154353562005277, 0.5923482849604221, 0.5934476693051891, 0.5793755496921724, 0.5813544415127528, 0.5868513632365875, 0.5857519788918206, 0.5837730870712401, 0.5856209150326798]
Durations: [114.38550090789795, 224.50773572921753, 334.9790663719177, 444.8615868091583, 554.7388515472412, 664.6537897586823, 774.3442935943604, 884.1396660804749, 994.0344994068146, 1103.8730282783508, 1107.0093100070953]
Graphs saved to disk
