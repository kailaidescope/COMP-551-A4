Starting BERT epoch experiments script
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
{'eval_loss': 1.2931638956069946, 'eval_accuracy': 0.622471416007036, 'eval_f1': 0.45500106036319393, 'eval_runtime': 3.145, 'eval_samples_per_second': 1446.083, 'eval_steps_per_second': 90.619, 'epoch': 1.0}
{'eval_loss': 1.2694363594055176, 'eval_accuracy': 0.6220316622691293, 'eval_f1': 0.4766638094723773, 'eval_runtime': 3.1552, 'eval_samples_per_second': 1441.417, 'eval_steps_per_second': 90.326, 'epoch': 2.0}
{'eval_loss': 1.3295553922653198, 'eval_accuracy': 0.6116974494283202, 'eval_f1': 0.49157986353921723, 'eval_runtime': 3.1578, 'eval_samples_per_second': 1440.257, 'eval_steps_per_second': 90.254, 'epoch': 3.0}
{'eval_loss': 1.534387230873108, 'eval_accuracy': 0.5881706244503079, 'eval_f1': 0.48503021807224306, 'eval_runtime': 3.1305, 'eval_samples_per_second': 1452.814, 'eval_steps_per_second': 91.04, 'epoch': 4.0}
{'eval_loss': 1.7173051834106445, 'eval_accuracy': 0.5886103781882146, 'eval_f1': 0.4807441705508021, 'eval_runtime': 3.1511, 'eval_samples_per_second': 1443.314, 'eval_steps_per_second': 90.445, 'epoch': 5.0}
{'eval_loss': 2.0096499919891357, 'eval_accuracy': 0.5875109938434476, 'eval_f1': 0.47667953548877834, 'eval_runtime': 3.1455, 'eval_samples_per_second': 1445.891, 'eval_steps_per_second': 90.607, 'epoch': 6.0}
{'eval_loss': 2.2894158363342285, 'eval_accuracy': 0.582014072119613, 'eval_f1': 0.48580741273759165, 'eval_runtime': 3.1411, 'eval_samples_per_second': 1447.885, 'eval_steps_per_second': 90.732, 'epoch': 7.0}
{'eval_loss': 2.443387269973755, 'eval_accuracy': 0.5890501319261213, 'eval_f1': 0.4840872547860786, 'eval_runtime': 3.1506, 'eval_samples_per_second': 1443.541, 'eval_steps_per_second': 90.459, 'epoch': 8.0}
{'eval_loss': 2.6321051120758057, 'eval_accuracy': 0.580255057167986, 'eval_f1': 0.4689646433323425, 'eval_runtime': 3.1449, 'eval_samples_per_second': 1446.144, 'eval_steps_per_second': 90.622, 'epoch': 9.0}
{'eval_loss': 2.6922781467437744, 'eval_accuracy': 0.578056288478452, 'eval_f1': 0.4642521519529384, 'eval_runtime': 3.1996, 'eval_samples_per_second': 1421.421, 'eval_steps_per_second': 89.073, 'epoch': 10.0}
{'train_runtime': 1105.1283, 'train_samples_per_second': 328.541, 'train_steps_per_second': 20.541, 'train_loss': 0.55332969094163, 'epoch': 10.0}
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [24 11 20 ... 27  0 27]
Metrics:
F1: 0.49021254036111944 
Accuracy: 0.5788671023965142
Results: {'f1': [0.45500106036319393, 0.4766638094723773, 0.49157986353921723, 0.48503021807224306, 0.4807441705508021, 0.47667953548877834, 0.48580741273759165, 0.4840872547860786, 0.4689646433323425, 0.4642521519529384, 0.49021254036111944], 'accuracy': [0.622471416007036, 0.6220316622691293, 0.6116974494283202, 0.5881706244503079, 0.5886103781882146, 0.5875109938434476, 0.582014072119613, 0.5890501319261213, 0.580255057167986, 0.578056288478452, 0.5788671023965142], 'duration': [115.1780161857605, 225.39214444160461, 336.0591299533844, 445.95682740211487, 556.1653525829315, 666.8593804836273, 777.602668762207, 888.3955256938934, 999.4757986068726, 1110.3783977031708, 1113.5793964862823], 'final': {'f1': 0.49021254036111944, 'accuracy': 0.5788671023965142, 'duration': 1113.5829305648804}}
F1 scores: [0.45500106036319393, 0.4766638094723773, 0.49157986353921723, 0.48503021807224306, 0.4807441705508021, 0.47667953548877834, 0.48580741273759165, 0.4840872547860786, 0.4689646433323425, 0.4642521519529384, 0.49021254036111944]
Accuracies: [0.622471416007036, 0.6220316622691293, 0.6116974494283202, 0.5881706244503079, 0.5886103781882146, 0.5875109938434476, 0.582014072119613, 0.5890501319261213, 0.580255057167986, 0.578056288478452, 0.5788671023965142]
Durations: [115.1780161857605, 225.39214444160461, 336.0591299533844, 445.95682740211487, 556.1653525829315, 666.8593804836273, 777.602668762207, 888.3955256938934, 999.4757986068726, 1110.3783977031708, 1113.5793964862823]
