Starting BERT epoch experiments script
Only train head: True
Learning rate: 0.01 
Num epochs: 16 
Batch size: 16 
Weight decay: 0.01
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
{'loss': 3.1893, 'grad_norm': 7.36015510559082, 'learning_rate': 0.009375, 'epoch': 1.0}
{'eval_loss': 2.8503847122192383, 'eval_accuracy': 0.3702726473175022, 'eval_f1': 0.09453628334683162, 'eval_runtime': 3.0491, 'eval_samples_per_second': 1491.601, 'eval_steps_per_second': 93.471, 'epoch': 1.0}
{'loss': 3.0257, 'grad_norm': 6.566728115081787, 'learning_rate': 0.00875, 'epoch': 2.0}
{'eval_loss': 3.284846782684326, 'eval_accuracy': 0.3676341248900616, 'eval_f1': 0.07635745253161552, 'eval_runtime': 3.0596, 'eval_samples_per_second': 1486.478, 'eval_steps_per_second': 93.15, 'epoch': 2.0}
{'loss': 2.9501, 'grad_norm': 12.164678573608398, 'learning_rate': 0.008125, 'epoch': 3.0}
{'eval_loss': 2.454629898071289, 'eval_accuracy': 0.405452946350044, 'eval_f1': 0.11075056166704104, 'eval_runtime': 3.0789, 'eval_samples_per_second': 1477.169, 'eval_steps_per_second': 92.567, 'epoch': 3.0}
{'loss': 2.8835, 'grad_norm': 6.390288352966309, 'learning_rate': 0.0075, 'epoch': 4.0}
{'eval_loss': 2.4516756534576416, 'eval_accuracy': 0.3992963940193492, 'eval_f1': 0.1657457423997861, 'eval_runtime': 3.0789, 'eval_samples_per_second': 1477.143, 'eval_steps_per_second': 92.565, 'epoch': 4.0}
{'loss': 2.8068, 'grad_norm': 12.262019157409668, 'learning_rate': 0.006875, 'epoch': 5.0}
{'eval_loss': 2.840219259262085, 'eval_accuracy': 0.33465259454705365, 'eval_f1': 0.1039105385455966, 'eval_runtime': 3.0783, 'eval_samples_per_second': 1477.44, 'eval_steps_per_second': 92.584, 'epoch': 5.0}
{'loss': 2.7295, 'grad_norm': 12.18237590789795, 'learning_rate': 0.00625, 'epoch': 6.0}
{'eval_loss': 2.778778553009033, 'eval_accuracy': 0.30782761653474056, 'eval_f1': 0.10495117386264934, 'eval_runtime': 3.1013, 'eval_samples_per_second': 1466.463, 'eval_steps_per_second': 91.896, 'epoch': 6.0}
{'loss': 2.6635, 'grad_norm': 9.548585891723633, 'learning_rate': 0.005625, 'epoch': 7.0}
{'eval_loss': 2.5906403064727783, 'eval_accuracy': 0.3841248900615655, 'eval_f1': 0.09904936829106799, 'eval_runtime': 3.0905, 'eval_samples_per_second': 1471.622, 'eval_steps_per_second': 92.219, 'epoch': 7.0}
{'loss': 2.5896, 'grad_norm': 9.8908052444458, 'learning_rate': 0.005, 'epoch': 8.0}
{'eval_loss': 2.5331172943115234, 'eval_accuracy': 0.36455584872471414, 'eval_f1': 0.11590623170023019, 'eval_runtime': 3.0891, 'eval_samples_per_second': 1472.285, 'eval_steps_per_second': 92.261, 'epoch': 8.0}
{'loss': 2.4971, 'grad_norm': 7.396738052368164, 'learning_rate': 0.004375, 'epoch': 9.0}
{'eval_loss': 2.4800119400024414, 'eval_accuracy': 0.39797713280562885, 'eval_f1': 0.12734132693106268, 'eval_runtime': 3.0939, 'eval_samples_per_second': 1469.991, 'eval_steps_per_second': 92.117, 'epoch': 9.0}
{'loss': 2.4243, 'grad_norm': 7.468786239624023, 'learning_rate': 0.00375, 'epoch': 10.0}
{'eval_loss': 2.2385449409484863, 'eval_accuracy': 0.41380826737027265, 'eval_f1': 0.12733275699031982, 'eval_runtime': 3.0956, 'eval_samples_per_second': 1469.206, 'eval_steps_per_second': 92.068, 'epoch': 10.0}
{'loss': 2.3525, 'grad_norm': 9.585020065307617, 'learning_rate': 0.003125, 'epoch': 11.0}
{'eval_loss': 2.2168807983398438, 'eval_accuracy': 0.3575197889182058, 'eval_f1': 0.1586989148946932, 'eval_runtime': 3.1067, 'eval_samples_per_second': 1463.929, 'eval_steps_per_second': 91.737, 'epoch': 11.0}
{'loss': 2.285, 'grad_norm': 6.02522611618042, 'learning_rate': 0.0025, 'epoch': 12.0}
{'eval_loss': 2.230565309524536, 'eval_accuracy': 0.3762093227792436, 'eval_f1': 0.13474506182545795, 'eval_runtime': 3.096, 'eval_samples_per_second': 1468.997, 'eval_steps_per_second': 92.055, 'epoch': 12.0}
{'loss': 2.2169, 'grad_norm': 7.178704261779785, 'learning_rate': 0.001875, 'epoch': 13.0}
{'eval_loss': 2.0727651119232178, 'eval_accuracy': 0.4197449428320141, 'eval_f1': 0.15237134784802023, 'eval_runtime': 3.1001, 'eval_samples_per_second': 1467.057, 'eval_steps_per_second': 91.933, 'epoch': 13.0}
{'loss': 2.1543, 'grad_norm': 10.870367050170898, 'learning_rate': 0.00125, 'epoch': 14.0}
{'eval_loss': 2.017101764678955, 'eval_accuracy': 0.415127528583993, 'eval_f1': 0.19698300265856547, 'eval_runtime': 3.0933, 'eval_samples_per_second': 1470.269, 'eval_steps_per_second': 92.134, 'epoch': 14.0}
{'loss': 2.0955, 'grad_norm': 7.658146858215332, 'learning_rate': 0.000625, 'epoch': 15.0}
{'eval_loss': 1.9581422805786133, 'eval_accuracy': 0.44371152154793314, 'eval_f1': 0.1732319501168562, 'eval_runtime': 3.0924, 'eval_samples_per_second': 1470.691, 'eval_steps_per_second': 92.161, 'epoch': 15.0}
{'loss': 2.0326, 'grad_norm': 6.794032096862793, 'learning_rate': 0.0, 'epoch': 16.0}
{'eval_loss': 1.8524776697158813, 'eval_accuracy': 0.45822339489885666, 'eval_f1': 0.1853594050582317, 'eval_runtime': 3.0959, 'eval_samples_per_second': 1469.059, 'eval_steps_per_second': 92.058, 'epoch': 16.0}
{'train_runtime': 502.1869, 'train_samples_per_second': 1156.796, 'train_steps_per_second': 72.324, 'train_loss': 2.556020580409382, 'epoch': 16.0}
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [27 27 20 ... 27  0 27]
Metrics:
F1: 0.19526911137780928 
Accuracy: 0.4644880174291939
Results: {'f1': [0.09453628334683162, 0.07635745253161552, 0.11075056166704104, 0.1657457423997861, 0.1039105385455966, 0.10495117386264934, 0.09904936829106799, 0.11590623170023019, 0.12734132693106268, 0.12733275699031982, 0.1586989148946932, 0.13474506182545795, 0.15237134784802023, 0.19698300265856547, 0.1732319501168562, 0.1853594050582317, 0.19526911137780928], 'accuracy': [0.3702726473175022, 0.3676341248900616, 0.405452946350044, 0.3992963940193492, 0.33465259454705365, 0.30782761653474056, 0.3841248900615655, 0.36455584872471414, 0.39797713280562885, 0.41380826737027265, 0.3575197889182058, 0.3762093227792436, 0.4197449428320141, 0.415127528583993, 0.44371152154793314, 0.45822339489885666, 0.4644880174291939], 'duration': [38.570005893707275, 69.6870973110199, 100.93852043151855, 132.32226419448853, 163.67010712623596, 195.05659127235413, 226.6599953174591, 258.05661630630493, 289.4973542690277, 320.9307436943054, 352.5023171901703, 383.8910388946533, 415.36112880706787, 446.7212550640106, 478.13523173332214, 509.5192229747772, 512.7487790584564], 'final': {'f1': 0.19526911137780928, 'accuracy': 0.4644880174291939, 'duration': 512.7517971992493}}
F1 scores: [0.09453628334683162, 0.07635745253161552, 0.11075056166704104, 0.1657457423997861, 0.1039105385455966, 0.10495117386264934, 0.09904936829106799, 0.11590623170023019, 0.12734132693106268, 0.12733275699031982, 0.1586989148946932, 0.13474506182545795, 0.15237134784802023, 0.19698300265856547, 0.1732319501168562, 0.1853594050582317, 0.19526911137780928]
Accuracies: [0.3702726473175022, 0.3676341248900616, 0.405452946350044, 0.3992963940193492, 0.33465259454705365, 0.30782761653474056, 0.3841248900615655, 0.36455584872471414, 0.39797713280562885, 0.41380826737027265, 0.3575197889182058, 0.3762093227792436, 0.4197449428320141, 0.415127528583993, 0.44371152154793314, 0.45822339489885666, 0.4644880174291939]
Durations: [38.570005893707275, 69.6870973110199, 100.93852043151855, 132.32226419448853, 163.67010712623596, 195.05659127235413, 226.6599953174591, 258.05661630630493, 289.4973542690277, 320.9307436943054, 352.5023171901703, 383.8910388946533, 415.36112880706787, 446.7212550640106, 478.13523173332214, 509.5192229747772, 512.7487790584564]
log_history: [{'loss': 3.1893, 'grad_norm': 7.36015510559082, 'learning_rate': 0.009375, 'epoch': 1.0, 'step': 2270}, {'eval_loss': 2.8503847122192383, 'eval_accuracy': 0.3702726473175022, 'eval_f1': 0.09453628334683162, 'eval_runtime': 3.0491, 'eval_samples_per_second': 1491.601, 'eval_steps_per_second': 93.471, 'epoch': 1.0, 'step': 2270}, {'loss': 3.0257, 'grad_norm': 6.566728115081787, 'learning_rate': 0.00875, 'epoch': 2.0, 'step': 4540}, {'eval_loss': 3.284846782684326, 'eval_accuracy': 0.3676341248900616, 'eval_f1': 0.07635745253161552, 'eval_runtime': 3.0596, 'eval_samples_per_second': 1486.478, 'eval_steps_per_second': 93.15, 'epoch': 2.0, 'step': 4540}, {'loss': 2.9501, 'grad_norm': 12.164678573608398, 'learning_rate': 0.008125, 'epoch': 3.0, 'step': 6810}, {'eval_loss': 2.454629898071289, 'eval_accuracy': 0.405452946350044, 'eval_f1': 0.11075056166704104, 'eval_runtime': 3.0789, 'eval_samples_per_second': 1477.169, 'eval_steps_per_second': 92.567, 'epoch': 3.0, 'step': 6810}, {'loss': 2.8835, 'grad_norm': 6.390288352966309, 'learning_rate': 0.0075, 'epoch': 4.0, 'step': 9080}, {'eval_loss': 2.4516756534576416, 'eval_accuracy': 0.3992963940193492, 'eval_f1': 0.1657457423997861, 'eval_runtime': 3.0789, 'eval_samples_per_second': 1477.143, 'eval_steps_per_second': 92.565, 'epoch': 4.0, 'step': 9080}, {'loss': 2.8068, 'grad_norm': 12.262019157409668, 'learning_rate': 0.006875, 'epoch': 5.0, 'step': 11350}, {'eval_loss': 2.840219259262085, 'eval_accuracy': 0.33465259454705365, 'eval_f1': 0.1039105385455966, 'eval_runtime': 3.0783, 'eval_samples_per_second': 1477.44, 'eval_steps_per_second': 92.584, 'epoch': 5.0, 'step': 11350}, {'loss': 2.7295, 'grad_norm': 12.18237590789795, 'learning_rate': 0.00625, 'epoch': 6.0, 'step': 13620}, {'eval_loss': 2.778778553009033, 'eval_accuracy': 0.30782761653474056, 'eval_f1': 0.10495117386264934, 'eval_runtime': 3.1013, 'eval_samples_per_second': 1466.463, 'eval_steps_per_second': 91.896, 'epoch': 6.0, 'step': 13620}, {'loss': 2.6635, 'grad_norm': 9.548585891723633, 'learning_rate': 0.005625, 'epoch': 7.0, 'step': 15890}, {'eval_loss': 2.5906403064727783, 'eval_accuracy': 0.3841248900615655, 'eval_f1': 0.09904936829106799, 'eval_runtime': 3.0905, 'eval_samples_per_second': 1471.622, 'eval_steps_per_second': 92.219, 'epoch': 7.0, 'step': 15890}, {'loss': 2.5896, 'grad_norm': 9.8908052444458, 'learning_rate': 0.005, 'epoch': 8.0, 'step': 18160}, {'eval_loss': 2.5331172943115234, 'eval_accuracy': 0.36455584872471414, 'eval_f1': 0.11590623170023019, 'eval_runtime': 3.0891, 'eval_samples_per_second': 1472.285, 'eval_steps_per_second': 92.261, 'epoch': 8.0, 'step': 18160}, {'loss': 2.4971, 'grad_norm': 7.396738052368164, 'learning_rate': 0.004375, 'epoch': 9.0, 'step': 20430}, {'eval_loss': 2.4800119400024414, 'eval_accuracy': 0.39797713280562885, 'eval_f1': 0.12734132693106268, 'eval_runtime': 3.0939, 'eval_samples_per_second': 1469.991, 'eval_steps_per_second': 92.117, 'epoch': 9.0, 'step': 20430}, {'loss': 2.4243, 'grad_norm': 7.468786239624023, 'learning_rate': 0.00375, 'epoch': 10.0, 'step': 22700}, {'eval_loss': 2.2385449409484863, 'eval_accuracy': 0.41380826737027265, 'eval_f1': 0.12733275699031982, 'eval_runtime': 3.0956, 'eval_samples_per_second': 1469.206, 'eval_steps_per_second': 92.068, 'epoch': 10.0, 'step': 22700}, {'loss': 2.3525, 'grad_norm': 9.585020065307617, 'learning_rate': 0.003125, 'epoch': 11.0, 'step': 24970}, {'eval_loss': 2.2168807983398438, 'eval_accuracy': 0.3575197889182058, 'eval_f1': 0.1586989148946932, 'eval_runtime': 3.1067, 'eval_samples_per_second': 1463.929, 'eval_steps_per_second': 91.737, 'epoch': 11.0, 'step': 24970}, {'loss': 2.285, 'grad_norm': 6.02522611618042, 'learning_rate': 0.0025, 'epoch': 12.0, 'step': 27240}, {'eval_loss': 2.230565309524536, 'eval_accuracy': 0.3762093227792436, 'eval_f1': 0.13474506182545795, 'eval_runtime': 3.096, 'eval_samples_per_second': 1468.997, 'eval_steps_per_second': 92.055, 'epoch': 12.0, 'step': 27240}, {'loss': 2.2169, 'grad_norm': 7.178704261779785, 'learning_rate': 0.001875, 'epoch': 13.0, 'step': 29510}, {'eval_loss': 2.0727651119232178, 'eval_accuracy': 0.4197449428320141, 'eval_f1': 0.15237134784802023, 'eval_runtime': 3.1001, 'eval_samples_per_second': 1467.057, 'eval_steps_per_second': 91.933, 'epoch': 13.0, 'step': 29510}, {'loss': 2.1543, 'grad_norm': 10.870367050170898, 'learning_rate': 0.00125, 'epoch': 14.0, 'step': 31780}, {'eval_loss': 2.017101764678955, 'eval_accuracy': 0.415127528583993, 'eval_f1': 0.19698300265856547, 'eval_runtime': 3.0933, 'eval_samples_per_second': 1470.269, 'eval_steps_per_second': 92.134, 'epoch': 14.0, 'step': 31780}, {'loss': 2.0955, 'grad_norm': 7.658146858215332, 'learning_rate': 0.000625, 'epoch': 15.0, 'step': 34050}, {'eval_loss': 1.9581422805786133, 'eval_accuracy': 0.44371152154793314, 'eval_f1': 0.1732319501168562, 'eval_runtime': 3.0924, 'eval_samples_per_second': 1470.691, 'eval_steps_per_second': 92.161, 'epoch': 15.0, 'step': 34050}, {'loss': 2.0326, 'grad_norm': 6.794032096862793, 'learning_rate': 0.0, 'epoch': 16.0, 'step': 36320}, {'eval_loss': 1.8524776697158813, 'eval_accuracy': 0.45822339489885666, 'eval_f1': 0.1853594050582317, 'eval_runtime': 3.0959, 'eval_samples_per_second': 1469.059, 'eval_steps_per_second': 92.058, 'epoch': 16.0, 'step': 36320}, {'train_runtime': 502.1869, 'train_samples_per_second': 1156.796, 'train_steps_per_second': 72.324, 'total_flos': 1.023132348897024e+16, 'train_loss': 2.556020580409382, 'epoch': 16.0, 'step': 36320}]
Training Losses ( 16 ): [3.1893, 3.0257, 2.9501, 2.8835, 2.8068, 2.7295, 2.6635, 2.5896, 2.4971, 2.4243, 2.3525, 2.285, 2.2169, 2.1543, 2.0955, 2.0326]
Validation Losses ( 16 ): [2.8503847122192383, 3.284846782684326, 2.454629898071289, 2.4516756534576416, 2.840219259262085, 2.778778553009033, 2.5906403064727783, 2.5331172943115234, 2.4800119400024414, 2.2385449409484863, 2.2168807983398438, 2.230565309524536, 2.0727651119232178, 2.017101764678955, 1.9581422805786133, 1.8524776697158813]
Graphs saved to disk
