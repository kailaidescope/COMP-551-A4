Starting BERT fine-tuning script
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
{'eval_loss': 1.286671757698059, 'eval_accuracy': 0.6226912928759895, 'eval_f1': 0.45201849106756564, 'eval_runtime': 3.1082, 'eval_samples_per_second': 1463.238, 'eval_steps_per_second': 91.694, 'epoch': 1.0}
{'eval_loss': 1.2477778196334839, 'eval_accuracy': 0.6334652594547053, 'eval_f1': 0.48161091619161295, 'eval_runtime': 3.1454, 'eval_samples_per_second': 1445.918, 'eval_steps_per_second': 90.608, 'epoch': 2.0}
{'eval_loss': 1.2872096300125122, 'eval_accuracy': 0.6255496921723834, 'eval_f1': 0.48413022007578055, 'eval_runtime': 3.1602, 'eval_samples_per_second': 1439.152, 'eval_steps_per_second': 90.184, 'epoch': 3.0}
{'train_runtime': 329.7094, 'train_samples_per_second': 330.364, 'train_steps_per_second': 20.655, 'train_loss': 1.2231250286802495, 'epoch': 3.0}
Classification head saved.
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [25  0 20 ... 27  0 27]
Metrics:/nF1: 0.5035738418666339 
Accuracy: 0.6313725490196078
