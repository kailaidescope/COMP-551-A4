Starting BERT epoch experiments script
Only train head: True
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
{'eval_loss': 1.2931499481201172, 'eval_accuracy': 0.6189533861037819, 'eval_f1': 0.4552656876678557, 'eval_runtime': 3.085, 'eval_samples_per_second': 1474.209, 'eval_steps_per_second': 92.381, 'epoch': 1.0}
{'eval_loss': 1.2714848518371582, 'eval_accuracy': 0.6198328935795955, 'eval_f1': 0.47893565132458366, 'eval_runtime': 3.1122, 'eval_samples_per_second': 1461.342, 'eval_steps_per_second': 91.575, 'epoch': 2.0}
{'eval_loss': 1.335858702659607, 'eval_accuracy': 0.6072999120492524, 'eval_f1': 0.4882111829876696, 'eval_runtime': 3.0926, 'eval_samples_per_second': 1470.619, 'eval_steps_per_second': 92.156, 'epoch': 3.0}
{'eval_loss': 1.5388939380645752, 'eval_accuracy': 0.5857519788918206, 'eval_f1': 0.48378369979151337, 'eval_runtime': 3.0949, 'eval_samples_per_second': 1469.518, 'eval_steps_per_second': 92.087, 'epoch': 4.0}
{'eval_loss': 1.7638213634490967, 'eval_accuracy': 0.5866314863676341, 'eval_f1': 0.4764148662828166, 'eval_runtime': 3.088, 'eval_samples_per_second': 1472.808, 'eval_steps_per_second': 92.293, 'epoch': 5.0}
{'eval_loss': 2.0166563987731934, 'eval_accuracy': 0.5826737027264732, 'eval_f1': 0.47286347833858006, 'eval_runtime': 3.0953, 'eval_samples_per_second': 1469.309, 'eval_steps_per_second': 92.074, 'epoch': 6.0}
{'eval_loss': 2.283597707748413, 'eval_accuracy': 0.5756376429199648, 'eval_f1': 0.4745749373601013, 'eval_runtime': 3.0951, 'eval_samples_per_second': 1469.4, 'eval_steps_per_second': 92.08, 'epoch': 7.0}
{'eval_loss': 2.454829692840576, 'eval_accuracy': 0.5800351802990326, 'eval_f1': 0.4814343148864309, 'eval_runtime': 3.0946, 'eval_samples_per_second': 1469.636, 'eval_steps_per_second': 92.095, 'epoch': 8.0}
{'eval_loss': 2.614295482635498, 'eval_accuracy': 0.5815743183817063, 'eval_f1': 0.4761915847986405, 'eval_runtime': 3.097, 'eval_samples_per_second': 1468.522, 'eval_steps_per_second': 92.025, 'epoch': 9.0}
{'eval_loss': 2.672445297241211, 'eval_accuracy': 0.5809146877748461, 'eval_f1': 0.48238435749207537, 'eval_runtime': 3.0949, 'eval_samples_per_second': 1469.502, 'eval_steps_per_second': 92.086, 'epoch': 10.0}
{'train_runtime': 1091.0763, 'train_samples_per_second': 332.772, 'train_steps_per_second': 20.805, 'train_loss': 0.5584393928964758, 'epoch': 10.0}
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [25  0 20 ... 27  0 27]
Metrics:
F1: 0.47973282376874415 
Accuracy: 0.5723311546840959
Results: {'f1': [0.4552656876678557, 0.47893565132458366, 0.4882111829876696, 0.48378369979151337, 0.4764148662828166, 0.47286347833858006, 0.4745749373601013, 0.4814343148864309, 0.4761915847986405, 0.48238435749207537, 0.47973282376874415], 'accuracy': [0.6189533861037819, 0.6198328935795955, 0.6072999120492524, 0.5857519788918206, 0.5866314863676341, 0.5826737027264732, 0.5756376429199648, 0.5800351802990326, 0.5815743183817063, 0.5809146877748461, 0.5723311546840959], 'duration': [110.28396272659302, 219.5398669242859, 329.2074885368347, 438.06612753868103, 547.0500571727753, 656.1692590713501, 765.3064308166504, 874.5201985836029, 983.9092488288879, 1093.2549633979797, 1096.352698802948], 'final': {'f1': 0.47973282376874415, 'accuracy': 0.5723311546840959, 'duration': 1096.3563992977142}}
F1 scores: [0.4552656876678557, 0.47893565132458366, 0.4882111829876696, 0.48378369979151337, 0.4764148662828166, 0.47286347833858006, 0.4745749373601013, 0.4814343148864309, 0.4761915847986405, 0.48238435749207537, 0.47973282376874415]
Accuracies: [0.6189533861037819, 0.6198328935795955, 0.6072999120492524, 0.5857519788918206, 0.5866314863676341, 0.5826737027264732, 0.5756376429199648, 0.5800351802990326, 0.5815743183817063, 0.5809146877748461, 0.5723311546840959]
Durations: [110.28396272659302, 219.5398669242859, 329.2074885368347, 438.06612753868103, 547.0500571727753, 656.1692590713501, 765.3064308166504, 874.5201985836029, 983.9092488288879, 1093.2549633979797, 1096.352698802948]
Training Losses ( 0 ): []
Validation Losses ( 10 ): [1.2931499481201172, 1.2714848518371582, 1.335858702659607, 1.5388939380645752, 1.7638213634490967, 2.0166563987731934, 2.283597707748413, 2.454829692840576, 2.614295482635498, 2.672445297241211]
Graphs saved to disk
