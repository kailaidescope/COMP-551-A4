Starting BERT epoch experiments script
Only train head: True
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
Learning rate: 0.01 
Num epochs: 16
{'loss': 2.6683, 'grad_norm': 6.703379154205322, 'learning_rate': 1.8750000000000002e-05, 'epoch': 1.0}
{'eval_loss': 2.576751708984375, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0059, 'eval_samples_per_second': 1513.013, 'eval_steps_per_second': 94.813, 'epoch': 1.0}
{'loss': 2.578, 'grad_norm': 6.354760646820068, 'learning_rate': 1.7500000000000002e-05, 'epoch': 2.0}
{'eval_loss': 2.553480863571167, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0413, 'eval_samples_per_second': 1495.434, 'eval_steps_per_second': 93.711, 'epoch': 2.0}
{'loss': 2.5575, 'grad_norm': 10.016946792602539, 'learning_rate': 1.6250000000000002e-05, 'epoch': 3.0}
{'eval_loss': 2.5349338054656982, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0458, 'eval_samples_per_second': 1493.227, 'eval_steps_per_second': 93.573, 'epoch': 3.0}
{'loss': 2.5418, 'grad_norm': 6.137660026550293, 'learning_rate': 1.5000000000000002e-05, 'epoch': 4.0}
{'eval_loss': 2.520042657852173, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0686, 'eval_samples_per_second': 1482.108, 'eval_steps_per_second': 92.876, 'epoch': 4.0}
{'loss': 2.5294, 'grad_norm': 9.766927719116211, 'learning_rate': 1.375e-05, 'epoch': 5.0}
{'eval_loss': 2.505354166030884, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0734, 'eval_samples_per_second': 1479.792, 'eval_steps_per_second': 92.731, 'epoch': 5.0}
{'loss': 2.5179, 'grad_norm': 7.496749401092529, 'learning_rate': 1.25e-05, 'epoch': 6.0}
{'eval_loss': 2.4956300258636475, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0851, 'eval_samples_per_second': 1474.191, 'eval_steps_per_second': 92.38, 'epoch': 6.0}
{'loss': 2.509, 'grad_norm': 8.820184707641602, 'learning_rate': 1.125e-05, 'epoch': 7.0}
{'eval_loss': 2.4857990741729736, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0819, 'eval_samples_per_second': 1475.721, 'eval_steps_per_second': 92.476, 'epoch': 7.0}
{'loss': 2.4998, 'grad_norm': 6.792274475097656, 'learning_rate': 1e-05, 'epoch': 8.0}
{'eval_loss': 2.476634979248047, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0855, 'eval_samples_per_second': 1473.979, 'eval_steps_per_second': 92.367, 'epoch': 8.0}
{'loss': 2.4917, 'grad_norm': 6.442882537841797, 'learning_rate': 8.750000000000001e-06, 'epoch': 9.0}
{'eval_loss': 2.4709572792053223, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.018520241973010703, 'eval_runtime': 3.0828, 'eval_samples_per_second': 1475.3, 'eval_steps_per_second': 92.45, 'epoch': 9.0}
{'loss': 2.4881, 'grad_norm': 7.513349533081055, 'learning_rate': 7.500000000000001e-06, 'epoch': 10.0}
{'eval_loss': 2.4638938903808594, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0807, 'eval_samples_per_second': 1476.307, 'eval_steps_per_second': 92.513, 'epoch': 10.0}
{'loss': 2.4817, 'grad_norm': 10.422992706298828, 'learning_rate': 6.25e-06, 'epoch': 11.0}
{'eval_loss': 2.4598426818847656, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0817, 'eval_samples_per_second': 1475.828, 'eval_steps_per_second': 92.483, 'epoch': 11.0}
{'loss': 2.4779, 'grad_norm': 6.211010456085205, 'learning_rate': 5e-06, 'epoch': 12.0}
{'eval_loss': 2.4557712078094482, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0786, 'eval_samples_per_second': 1477.307, 'eval_steps_per_second': 92.575, 'epoch': 12.0}
{'loss': 2.474, 'grad_norm': 6.631275177001953, 'learning_rate': 3.7500000000000005e-06, 'epoch': 13.0}
{'eval_loss': 2.452275037765503, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0829, 'eval_samples_per_second': 1475.239, 'eval_steps_per_second': 92.446, 'epoch': 13.0}
{'loss': 2.471, 'grad_norm': 8.527575492858887, 'learning_rate': 2.5e-06, 'epoch': 14.0}
{'eval_loss': 2.45015025138855, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0817, 'eval_samples_per_second': 1475.824, 'eval_steps_per_second': 92.482, 'epoch': 14.0}
{'loss': 2.4683, 'grad_norm': 7.532140254974365, 'learning_rate': 1.25e-06, 'epoch': 15.0}
{'eval_loss': 2.448929786682129, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0773, 'eval_samples_per_second': 1477.904, 'eval_steps_per_second': 92.613, 'epoch': 15.0}
{'loss': 2.4691, 'grad_norm': 7.057462215423584, 'learning_rate': 0.0, 'epoch': 16.0}
{'eval_loss': 2.4485504627227783, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0844, 'eval_samples_per_second': 1474.509, 'eval_steps_per_second': 92.4, 'epoch': 16.0}
{'train_runtime': 499.4712, 'train_samples_per_second': 1163.086, 'train_steps_per_second': 72.717, 'train_loss': 2.5139793496825096, 'epoch': 16.0}
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [27 27 27 ... 27 27 27]
Metrics:
F1: 0.018514248824126164 
Accuracy: 0.3498910675381264
Results: {'f1': [0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.018520241973010703, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.018514248824126164], 'accuracy': [0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3498910675381264], 'duration': [34.88338589668274, 65.71407914161682, 96.71340727806091, 127.83263230323792, 159.02494478225708, 190.30799460411072, 221.57656908035278, 252.86521458625793, 284.1667535305023, 315.4924957752228, 346.8092050552368, 378.1095938682556, 409.43258023262024, 440.7278275489807, 472.06394362449646, 503.38863945007324, 506.48121309280396], 'final': {'f1': 0.018514248824126164, 'accuracy': 0.3498910675381264, 'duration': 506.48364090919495}}
F1 scores: [0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.018520241973010703, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.01852325879040328, 0.018514248824126164]
Accuracies: [0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3500439753737907, 0.3498910675381264]
Durations: [34.88338589668274, 65.71407914161682, 96.71340727806091, 127.83263230323792, 159.02494478225708, 190.30799460411072, 221.57656908035278, 252.86521458625793, 284.1667535305023, 315.4924957752228, 346.8092050552368, 378.1095938682556, 409.43258023262024, 440.7278275489807, 472.06394362449646, 503.38863945007324, 506.48121309280396]
log_history: [{'loss': 2.6683, 'grad_norm': 6.703379154205322, 'learning_rate': 1.8750000000000002e-05, 'epoch': 1.0, 'step': 2270}, {'eval_loss': 2.576751708984375, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0059, 'eval_samples_per_second': 1513.013, 'eval_steps_per_second': 94.813, 'epoch': 1.0, 'step': 2270}, {'loss': 2.578, 'grad_norm': 6.354760646820068, 'learning_rate': 1.7500000000000002e-05, 'epoch': 2.0, 'step': 4540}, {'eval_loss': 2.553480863571167, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0413, 'eval_samples_per_second': 1495.434, 'eval_steps_per_second': 93.711, 'epoch': 2.0, 'step': 4540}, {'loss': 2.5575, 'grad_norm': 10.016946792602539, 'learning_rate': 1.6250000000000002e-05, 'epoch': 3.0, 'step': 6810}, {'eval_loss': 2.5349338054656982, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0458, 'eval_samples_per_second': 1493.227, 'eval_steps_per_second': 93.573, 'epoch': 3.0, 'step': 6810}, {'loss': 2.5418, 'grad_norm': 6.137660026550293, 'learning_rate': 1.5000000000000002e-05, 'epoch': 4.0, 'step': 9080}, {'eval_loss': 2.520042657852173, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0686, 'eval_samples_per_second': 1482.108, 'eval_steps_per_second': 92.876, 'epoch': 4.0, 'step': 9080}, {'loss': 2.5294, 'grad_norm': 9.766927719116211, 'learning_rate': 1.375e-05, 'epoch': 5.0, 'step': 11350}, {'eval_loss': 2.505354166030884, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0734, 'eval_samples_per_second': 1479.792, 'eval_steps_per_second': 92.731, 'epoch': 5.0, 'step': 11350}, {'loss': 2.5179, 'grad_norm': 7.496749401092529, 'learning_rate': 1.25e-05, 'epoch': 6.0, 'step': 13620}, {'eval_loss': 2.4956300258636475, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0851, 'eval_samples_per_second': 1474.191, 'eval_steps_per_second': 92.38, 'epoch': 6.0, 'step': 13620}, {'loss': 2.509, 'grad_norm': 8.820184707641602, 'learning_rate': 1.125e-05, 'epoch': 7.0, 'step': 15890}, {'eval_loss': 2.4857990741729736, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0819, 'eval_samples_per_second': 1475.721, 'eval_steps_per_second': 92.476, 'epoch': 7.0, 'step': 15890}, {'loss': 2.4998, 'grad_norm': 6.792274475097656, 'learning_rate': 1e-05, 'epoch': 8.0, 'step': 18160}, {'eval_loss': 2.476634979248047, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0855, 'eval_samples_per_second': 1473.979, 'eval_steps_per_second': 92.367, 'epoch': 8.0, 'step': 18160}, {'loss': 2.4917, 'grad_norm': 6.442882537841797, 'learning_rate': 8.750000000000001e-06, 'epoch': 9.0, 'step': 20430}, {'eval_loss': 2.4709572792053223, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.018520241973010703, 'eval_runtime': 3.0828, 'eval_samples_per_second': 1475.3, 'eval_steps_per_second': 92.45, 'epoch': 9.0, 'step': 20430}, {'loss': 2.4881, 'grad_norm': 7.513349533081055, 'learning_rate': 7.500000000000001e-06, 'epoch': 10.0, 'step': 22700}, {'eval_loss': 2.4638938903808594, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0807, 'eval_samples_per_second': 1476.307, 'eval_steps_per_second': 92.513, 'epoch': 10.0, 'step': 22700}, {'loss': 2.4817, 'grad_norm': 10.422992706298828, 'learning_rate': 6.25e-06, 'epoch': 11.0, 'step': 24970}, {'eval_loss': 2.4598426818847656, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0817, 'eval_samples_per_second': 1475.828, 'eval_steps_per_second': 92.483, 'epoch': 11.0, 'step': 24970}, {'loss': 2.4779, 'grad_norm': 6.211010456085205, 'learning_rate': 5e-06, 'epoch': 12.0, 'step': 27240}, {'eval_loss': 2.4557712078094482, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0786, 'eval_samples_per_second': 1477.307, 'eval_steps_per_second': 92.575, 'epoch': 12.0, 'step': 27240}, {'loss': 2.474, 'grad_norm': 6.631275177001953, 'learning_rate': 3.7500000000000005e-06, 'epoch': 13.0, 'step': 29510}, {'eval_loss': 2.452275037765503, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0829, 'eval_samples_per_second': 1475.239, 'eval_steps_per_second': 92.446, 'epoch': 13.0, 'step': 29510}, {'loss': 2.471, 'grad_norm': 8.527575492858887, 'learning_rate': 2.5e-06, 'epoch': 14.0, 'step': 31780}, {'eval_loss': 2.45015025138855, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0817, 'eval_samples_per_second': 1475.824, 'eval_steps_per_second': 92.482, 'epoch': 14.0, 'step': 31780}, {'loss': 2.4683, 'grad_norm': 7.532140254974365, 'learning_rate': 1.25e-06, 'epoch': 15.0, 'step': 34050}, {'eval_loss': 2.448929786682129, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0773, 'eval_samples_per_second': 1477.904, 'eval_steps_per_second': 92.613, 'epoch': 15.0, 'step': 34050}, {'loss': 2.4691, 'grad_norm': 7.057462215423584, 'learning_rate': 0.0, 'epoch': 16.0, 'step': 36320}, {'eval_loss': 2.4485504627227783, 'eval_accuracy': 0.3500439753737907, 'eval_f1': 0.01852325879040328, 'eval_runtime': 3.0844, 'eval_samples_per_second': 1474.509, 'eval_steps_per_second': 92.4, 'epoch': 16.0, 'step': 36320}, {'train_runtime': 499.4712, 'train_samples_per_second': 1163.086, 'train_steps_per_second': 72.717, 'total_flos': 1.023132348897024e+16, 'train_loss': 2.5139793496825096, 'epoch': 16.0, 'step': 36320}]
Training Losses ( 16 ): [2.6683, 2.578, 2.5575, 2.5418, 2.5294, 2.5179, 2.509, 2.4998, 2.4917, 2.4881, 2.4817, 2.4779, 2.474, 2.471, 2.4683, 2.4691]
Validation Losses ( 16 ): [2.576751708984375, 2.553480863571167, 2.5349338054656982, 2.520042657852173, 2.505354166030884, 2.4956300258636475, 2.4857990741729736, 2.476634979248047, 2.4709572792053223, 2.4638938903808594, 2.4598426818847656, 2.4557712078094482, 2.452275037765503, 2.45015025138855, 2.448929786682129, 2.4485504627227783]
Graphs saved to disk
