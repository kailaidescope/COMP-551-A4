Starting BERT epoch experiments script
Loading model
Device: cuda
Fine-tuning the model on the GoEmotions dataset...
Filtered dataset:
 DatasetDict({
    train: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 36308
    })
    validation: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4548
    })
    test: Dataset({
        features: ['text', 'labels', 'id'],
        num_rows: 4590
    })
})
{'eval_loss': 1.2919687032699585, 'eval_accuracy': 0.617854001759015, 'eval_f1': 0.4530085849972698, 'eval_runtime': 3.0959, 'eval_samples_per_second': 1469.034, 'eval_steps_per_second': 92.057, 'epoch': 1.0}
{'eval_loss': 1.2560851573944092, 'eval_accuracy': 0.6218117854001759, 'eval_f1': 0.4836148482290209, 'eval_runtime': 3.1237, 'eval_samples_per_second': 1455.951, 'eval_steps_per_second': 91.237, 'epoch': 2.0}
{'eval_loss': 1.3262057304382324, 'eval_accuracy': 0.6092788038698329, 'eval_f1': 0.476168746377533, 'eval_runtime': 3.1232, 'eval_samples_per_second': 1456.182, 'eval_steps_per_second': 91.252, 'epoch': 3.0}
{'eval_loss': 1.511457085609436, 'eval_accuracy': 0.594547053649956, 'eval_f1': 0.4849341032467653, 'eval_runtime': 3.1158, 'eval_samples_per_second': 1459.644, 'eval_steps_per_second': 91.468, 'epoch': 4.0}
{'eval_loss': 1.72491455078125, 'eval_accuracy': 0.5903693931398417, 'eval_f1': 0.4850040403914924, 'eval_runtime': 3.1264, 'eval_samples_per_second': 1454.719, 'eval_steps_per_second': 91.16, 'epoch': 5.0}
{'eval_loss': 2.0160906314849854, 'eval_accuracy': 0.582014072119613, 'eval_f1': 0.47497096009755907, 'eval_runtime': 3.1111, 'eval_samples_per_second': 1461.864, 'eval_steps_per_second': 91.608, 'epoch': 6.0}
{'eval_loss': 2.2648093700408936, 'eval_accuracy': 0.580255057167986, 'eval_f1': 0.4918311791557044, 'eval_runtime': 3.1123, 'eval_samples_per_second': 1461.29, 'eval_steps_per_second': 91.572, 'epoch': 7.0}
{'eval_loss': 2.4845707416534424, 'eval_accuracy': 0.5776165347405453, 'eval_f1': 0.4857740430515897, 'eval_runtime': 3.1262, 'eval_samples_per_second': 1454.814, 'eval_steps_per_second': 91.166, 'epoch': 8.0}
{'eval_loss': 2.6536476612091064, 'eval_accuracy': 0.5784960422163589, 'eval_f1': 0.4920575090635471, 'eval_runtime': 3.1315, 'eval_samples_per_second': 1452.355, 'eval_steps_per_second': 91.012, 'epoch': 9.0}
{'eval_loss': 2.6972687244415283, 'eval_accuracy': 0.5795954265611257, 'eval_f1': 0.49515072326616616, 'eval_runtime': 3.1291, 'eval_samples_per_second': 1453.464, 'eval_steps_per_second': 91.081, 'epoch': 10.0}
{'train_runtime': 1094.0061, 'train_samples_per_second': 331.881, 'train_steps_per_second': 20.749, 'train_loss': 0.56763671875, 'epoch': 10.0}
Predictions shape:  (4590, 28) 
Labels shape:  (4590, 1) 
Class Predictions:  [24  0 20 ... 27  0 27]
Metrics:
F1: 0.49871802899424317 
Accuracy: 0.5851851851851851
Results: {'f1': [0.4530085849972698, 0.4836148482290209, 0.476168746377533, 0.4849341032467653, 0.4850040403914924, 0.47497096009755907, 0.4918311791557044, 0.4857740430515897, 0.4920575090635471, 0.49515072326616616, 0.49871802899424317], 'accuracy': [0.617854001759015, 0.6218117854001759, 0.6092788038698329, 0.594547053649956, 0.5903693931398417, 0.582014072119613, 0.580255057167986, 0.5776165347405453, 0.5784960422163589, 0.5795954265611257, 0.5851851851851851], 'duration': [113.81537389755249, 223.09517288208008, 332.80693769454956, 442.1847221851349, 551.3970861434937, 660.8735642433167, 770.2090246677399, 879.6283028125763, 989.3829946517944, 1099.071831703186, 1102.2025113105774], 'final': {'f1': 0.49871802899424317, 'accuracy': 0.5851851851851851, 'duration': 1102.2056410312653}}
F1 scores: [0.4530085849972698, 0.4836148482290209, 0.476168746377533, 0.4849341032467653, 0.4850040403914924, 0.47497096009755907, 0.4918311791557044, 0.4857740430515897, 0.4920575090635471, 0.49515072326616616, 0.49871802899424317]
Accuracies: [0.617854001759015, 0.6218117854001759, 0.6092788038698329, 0.594547053649956, 0.5903693931398417, 0.582014072119613, 0.580255057167986, 0.5776165347405453, 0.5784960422163589, 0.5795954265611257, 0.5851851851851851]
Durations: [113.81537389755249, 223.09517288208008, 332.80693769454956, 442.1847221851349, 551.3970861434937, 660.8735642433167, 770.2090246677399, 879.6283028125763, 989.3829946517944, 1099.071831703186, 1102.2025113105774]
Graphs saved to disk
